<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
    <meta charset="UTF-8">
    <title>echarts使用百度地图</title>
    <style type="text/css">
        *{
            margin:0;
            padding:0
        }
        html,body{
            width:100%;
            height: 100%;
        }
    </style>
</head>
<body>
<div id="dituContent" style="width:100%;height:100%;"></div>
</body>
<script type="text/javascript" src="js/jquery-1.11.0.min.js"></script>
<script type="text/javascript" src="js/echarts.js"></script>
<script type="text/javascript" src="http://api.map.baidu.com/api?v=2.0&ak=vgQfNjTQDlCar24CrTIdWcwY"></script>
<script type="text/javascript" src="js/bmap.min.js"></script>
<script  type="text/javascript">
    $(function() {
    // 初始化地图
        //创建和初始化地图函数：
        function initMap(){
            createMap();//创建地图
            //setMapEvent();//设置地图事件
            addMapControl();//向地图添加控件
        }
        //创建地图函数：
        function createMap(){
            var map = new BMap.Map("dituContent",{enableMapClick:false});//在百度地图容器中创建一个地图
            var point = new BMap.Point(114.065399,22.545602);//定义一个中心点坐标
            map.centerAndZoom(point,14);//设定地图的中心点和坐标并将地图显示在地图容器中
            window.map = map;//将map变量存储在全局
        }

        //地图事件设置函数：
        function setMapEvent(){
            map.enableDragging();//启用地图拖拽事件，默认启用(可不写)
            map.enableScrollWheelZoom();//启用地图滚轮放大缩小
            map.enableDoubleClickZoom();//启用鼠标双击放大，默认启用(可不写)
            map.enableKeyboard();//启用键盘上下左右键移动地图
        }

        //地图控件添加函数：
        function addMapControl(){

        }

        initMap();//创建和初始化地图
        var data = [
            {name: '园东社区', value: 200},
            {name: '红荔社区', value: 301},
            {name: '南天社区', value: 222},
            {name: '长城社区', value: 303},
            {name: '鹏盛社区', value: 200},
            {name: '华林社区', value: 200},
            {name: '玉田社区', value: 250},
            {name: '滨江社区', value: 256},
            {name: '巴登社区', value: 206},
            {name: '东园社区', value: 166},
            {name: '沙埔头社区', value: 206},
            {name: '锦龙社区', value: 306},
            {name: '园西社区', value: 106},
            {name: '南华社区', value: 326},
            {name: '赤尾社区', value: 226},
            {name: '滨河社区', value: 126},
            {name: '渔农社区', value: 186},
            {name: '水围社区', value: 126},
            {name: '皇岗社区', value: 136},
            {name: '海滨社区', value: 306},
            {name: '福民社区', value: 206},
            {name: '口岸社区', value: 346},
            {name: '福安社区', value: 156},
            {name: '岗厦社区', value: 306},
            {name: '福山社区', value: 306},
            {name: '福田社区', value: 306},
            {name: '福华社区', value: 306},
            {name: '天安社区', value: 306},
            {name: '金城社区', value: 306},
            {name: '新沙社区', value: 306},
            {name: '金地社区', value: 306},
            {name: '新华社区', value: 306},
            {name: '翠湾社区', value: 306},

        ];
        var geoCoordMap = {
            '园东社区':[114.1108, 22.5607],
            '红荔社区':[114.1045, 22.5601],
            '南天社区':[114.1013, 22.5603],
            '长城社区':[114.0948, 22.5588],
            '鹏盛社区':[114.1070, 22.5630],
            '华林社区':[114.1030, 22.5652],
            '玉田社区':[114.1024, 22.5423],
            '滨江社区':[114.1080, 22.5430],
            '巴登社区':[114.1088, 22.5455],
            '东园社区':[114.1088, 22.5438],
            '沙埔头社区':[114.0998, 22.5433],
            '锦龙社区':[114.0948, 22.5413],
            '园西社区':[114.0942, 22.5442],
            '南华社区':[114.0947, 22.5397],
            '赤尾社区':[114.0930, 22.5380],
            '滨河社区':[114.0915, 22.5360],
            '渔农社区':[114.0806, 22.5220],
            '水围社区':[114.0710, 22.5260],
            '皇岗社区':[114.0670, 22.5310],
            '海滨社区':[114.0720, 22.5300],
            '福民社区':[114.0770, 22.5320],
            '口岸社区':[114.0860, 22.5330],
            '福安社区':[114.0590, 22.5380],
            '岗厦社区':[114.0778, 22.5433],
            '福山社区':[114.0778, 22.5363],
            '福田社区':[114.0848, 22.5378],
            '福华社区':[114.0898, 22.5438],
            '天安社区':[114.0380, 22.5370],
            '金城社区':[114.0030, 22.5370],
            '新沙社区':[114.0530, 22.5360],
            '金地社区':[114.0390, 22.5270],
            '新华社区':[114.0510, 22.5310],
            '翠湾社区':[114.0480, 22.5215],

        };
        var convertData = function (data) {
            var res = [];
            for (var i = 0; i < data.length; i++) {
                var geoCoord = geoCoordMap[data[i].name];
                if (geoCoord) {
                    res.push({
                        name: data[i].name,
                        value: geoCoord.concat(data[i].value)
                    });
                }
            }
            return res;
        };

        var myChart = echarts.init(document.getElementById('dituContent'));
        var option = {
            title: {
                text: '福田区银联POS机分布图',
                left: 'center'
            },
            tooltip : {
                trigger: 'item'
            },
            legend: {
                orient: 'vertical',
                y: 'bottom',
                x:'right',
                data:['密集'],
                textStyle: {
                    color: '#fff'
                },
                selectedMode: 'single'
            },
            bmap: {
                center: [114.0600, 22.5439],   //114.5435, 22.5439   左：侨城东路   右:红岭  上：梅岭水库    下：福田口岸
                zoom: 14,
                roam: true,
            },
            visualMap: {
                min: 100,
                max: 350,
                calculable: true,
                color: ['#d94e5d','#eac736','#50a3ba'],
                textStyle: {
                    color: '#fff'
                }
            },
            series : [
                {
                    name: '密集',
                    type: 'effectScatter',
                    coordinateSystem: 'bmap',
                    data: convertData(data.sort(function (a, b) {
                        return b.value - a.value;
                    }).slice(0, 56)),
                    symbolSize: function (val) {
                        return val[2] / 20;
                    },
                    showEffectOn: 'render',
                    rippleEffect: {
                        brushType: 'stroke'
                    },
                    hoverAnimation: true,
                    label: {
                        normal: {
                            formatter: '{b}',
                            position: 'right',
                            show: true
                        }
                    },
                    itemStyle: {
                        normal: {
                            color: 'purple',
                            shadowBlur: 10,
                            shadowColor: '#333'
                        }
                    },
                    zlevel: 999999
                }
            ]
        };
        myChart.setOption(option);
        myChart.on('click',function(prams){
            alert('11111');
        });

        /*var map = echarts.init(document.getElementById('dituContent'));
        var bmap = map.getModel().getComponent('dituContent').getMap();
        map.addEventListener('click',function(e){
            if(!e.overlay){
                e.stopPropagation()
            }
        })*/

    });
</script>
</html>

